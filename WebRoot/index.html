<!DOCTYPE html>
<html lang="zh_CN">
<head>
<link rel="stylesheet" href="css/bootstrap.min.css" />
<link rel="stylesheet" href="css/bootstrap-responsive.min.css" />
<link rel="stylesheet" href="css/top.css" />
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/highcharts.js"></script>
<title>Welcome</title>
<script type="text/javascript">
	var chart;
	var chart2;
	$(function() {
		plotWeather();
		getWeather();
	});
	function plotWeather() {
		chart = new Highcharts.Chart({
			chart : {
				type : 'line',
				renderTo : 'temperature'
			},
			title : {
				text : 'Temperature in dorm and outsite'
			},
			subtitle : {
				text : 'in the latest 24 hours'
			},
			xAxis : {
				type : 'datetime',
				dateTimeLabelFormats : {
					second : '%H:%M:%S'
				}
			},
			yAxis : {
				title : {
					text : 'Temperature (â„ƒ)'
				}
			},
			plotOptions : {
				line : {
					dataLabels : {
						enabled : true
					},
					enableMouseTracking : false
				}
			},
			series : [ {
				name : 'In dorm',
				data : []
			}, {
				name : 'Hangzhou',
				data : []
			} ]
		});
		chart2 = new Highcharts.Chart({
			chart : {
				type : 'line',
				renderTo : 'humidity'
			},
			title : {
				text : 'Humidity in dorm and outsite'
			},
			subtitle : {
				text : 'in the latest 24 hours'
			},
			xAxis : {
				type : 'datetime',
				dateTimeLabelFormats : {
					second : '%H:%M:%S'
				}
			},
			yAxis : {
				title : {
					text : 'Humidity (%)'
				}
			},
			plotOptions : {
				line : {
					dataLabels : {
						enabled : true
					},
					enableMouseTracking : false
				}
			},
			series : [ {
				name : 'In dorm',
				data : []
			}, {
				name : 'Hangzhou',
				data : []
			} ]
		});
	}
	function getWeather() {
		$.ajax({
			type : "GET",
			url : "/getweather",
			dataType : "json",
			cache : false,
			success : function(data) {
				var tArray = new Array(data.length);
				var tArray2 = new Array(data.length);
				if ($(data).length != 0) {
					for ( var i = 0; i < data.length; i++) {
						tArray[i] = new Array(Date.UTC(
								$(data).get(i).createDate.year + 1900, $(data)
										.get(i).createDate.month + 1, $(data)
										.get(i).createDate.date,
								$(data).get(i).createDate.hours,
								$(data).get(i).createDate.minutes, $(data).get(
										i).createDate.seconds),
								$(data).get(i).temperature);
						tArray2[i] = new Array(Date.UTC(
								$(data).get(i).createDate.year + 1900, $(data)
										.get(i).createDate.month + 1, $(data)
										.get(i).createDate.date,
								$(data).get(i).createDate.hours,
								$(data).get(i).createDate.minutes, $(data).get(
										i).createDate.seconds),
								$(data).get(i).humidity);
					}
				}
				chart.series[0].setData(tArray);
				chart2.series[0].setData(tArray2);
			}
		});
		$.ajax({
			type : "GET",
			url : "/getweatherhz",
			dataType : "json",
			cache : false,
			success : function(data) {
				var tArray = new Array(data.length);
				var tArray2 = new Array(data.length);
				if ($(data).length != 0) {
					for ( var i = 0; i < data.length; i++) {
						tArray[i] = new Array(Date.UTC(
								$(data).get(i).createDate.year + 1900, $(data)
										.get(i).createDate.month + 1, $(data)
										.get(i).createDate.date,
								$(data).get(i).createDate.hours,
								$(data).get(i).createDate.minutes, $(data).get(
										i).createDate.seconds),
								$(data).get(i).temperature);
						tArray2[i] = new Array(Date.UTC(
								$(data).get(i).createDate.year + 1900, $(data)
										.get(i).createDate.month + 1, $(data)
										.get(i).createDate.date,
								$(data).get(i).createDate.hours,
								$(data).get(i).createDate.minutes, $(data).get(
										i).createDate.seconds),
								$(data).get(i).humidity);
					}
				}
				chart.series[1].setData(tArray);
				chart2.series[1].setData(tArray2);
			}
		});
	}
</script>
</head>

<body data-spy="scroll" data-target=".bs-docs-sidebar">
	<script src="js/top.js"></script>
	<div class="row">
		<div id="myCarousel" class="carousel slide">
			<ol class="carousel-indicators">
				<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				<li data-target="#myCarousel" data-slide-to="1"></li>
				<li data-target="#myCarousel" data-slide-to="2"></li>
			</ol>
			<!-- Carousel items -->
			<div class="carousel-inner">
				<div class="active item">
					<img src="/img/1.jpg">
				</div>
				<div class="item">
					<img src="/img/2.jpg">
				</div>
				<div class="item">
					<img src="/img/3.jpg">
				</div>
			</div>
			<!-- Carousel nav -->
			<a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
			<a class="carousel-control right" href="#myCarousel"
				data-slide="next">&rsaquo;</a>
		</div>
		<div class="row">
			<div class="span1"></div>
			<div class="span11">
				<div id="temperature"></div>
				<div id="humidity"></div>
			</div>
		</div>
	</div>
</body>
</html>